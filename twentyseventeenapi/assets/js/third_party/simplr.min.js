(function(){window.simplr||(window.simplr={},simplr.dataStorage={},function(){function c(a,b){return a+"|"+((new Date).getTime()+b)}simplr.cache={set:function(a){var b=a&&a.key||"",d=a&&a.identifier||"",e=a&&a.data||"";a=a&&a.freshness||3155E7;return""!=b?(localStorage.setItem(b+"_time",c(d,a)),localStorage.setItem(b+"_data",e),simplr.cache.get({key:b,identifier:d})):null},get:function(a){var b=a&&a.key||"";a=a&&a.identifier||"";if(""!=b){var d=localStorage.getItem(b+"_time");if(null!=d&&(d=d.split("|"),
2==d.length&&d[0]==a))return(new Date).getTime()<=parseInt(d[1],10)?localStorage.getItem(b+"_data"):simplr.cache.expire(b)}return null},expire:function(a){localStorage.removeItem(a+"_time");localStorage.removeItem(a+"_data");return localStorage.getItem(a+"_data")}}}(),function(){simplr.dataStorage.view={views:{}};simplr.view={add:function(c){for(var a in c)simplr.dataStorage.view.views[a]={html:c[a].html||function(b){return""},callback:c[a].callback||function(b,a){}}},render:function(c){var a=c&&
c.name||"",b=c&&c.data||{};c=c&&c.selector||"";a&&c&&("string"==typeof c?document.querySelector(c).innerHTML=simplr.dataStorage.view.views[a].html(b):c.innerHTML=simplr.dataStorage.view.views[a].html(b),simplr.dataStorage.view.views[a].callback(c,b))}}}(),function(){simplr.dataStorage.command={crud:{view:!0,"new":!0,update:!0,"delete":!0},commands:{}};simplr.command={add:function(c){for(var a in c){var b=c[a]&&c[a].callback||function(){},d=(c[a]&&c[a].route||[]).join("_");d&&(simplr.dataStorage.command.commands[d]=
b)}},execute:function(c){c={route:[],url:c,resources:{},action:"",parameters:{}};"#"==c.url.charAt(0)&&(c.url=c.url.substring(1));"!"==c.url.charAt(0)&&(c.url=c.url.substring(1));var a=c.url.split("?");a[0]=decodeURI(a[0]);a[0]=a[0].split("/");c.action=a[0][a[0].length-1];c.action=simplr.dataStorage.command.crud[c.action]?c.action:"view";for(var b=!0,d="",e=0,g=a[0].length-1;e<g;e++)""!=a[0][e]&&(b?(d=a[0][e],c.route.push(d),c.resources[d]=""):c.resources[d]=a[0][e],b=!b);if(a[1])for(a=a[1].split("&"),
b=0,d=a.length;b<d;b++)e=a[b].split("="),c.parameters[e[0]]=decodeURIComponent(e[1]).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").trim();c.route.push(c.action);a=c.route.join("_");if(simplr.dataStorage.command.commands[a])simplr.dataStorage.command.commands[a](c)}};window.addEventListener("hashchange",function(){simplr.command.execute(window.location.hash)},!1)}(),function(){simplr.dataStorage.template={templates:{}};simplr.template={build:function(c){var a="";if(c&&c.component&&
c.tokens)for(var b="object"==typeof c.tokens&&c.tokens.length?c.tokens:[c.tokens],d=0;d<b.length;d++){var e={},g;for(g in b[d]){var f=e,k=g,h;h=b[d][g];h="object"==typeof h?simplr.template.build(h):h;f[k]=h}k=e;e=c.component;simplr.dataStorage.template.templates[e]||(f=document.getElementById("template-"+e))&&(simplr.dataStorage.template.templates[e]=f.textContent.replace(/\n/g,"").replace(/\s{1,}/g," ").trim());f=void 0;e=simplr.dataStorage.template.templates[e];if(void 0!==e)for(f in k)e=e.replace(new RegExp("\\$\\["+
f+"\\]","g"),escape(k[f]));e=unescape(e);a+=e}return a}}}(),function(){function c(b){return b===document?null:-1!=(" "+b.className+" ").replace(/[\t\r\n\f]/g," ").indexOf(" "+simplr.dataStorage.form.classes.formEntry+" ")?b:c(b.parentNode)}function a(b,a){var c=a,d;for(d in b)c=c.replace(new RegExp("\\$\\["+d+"\\]","g"),escape(b[d]));return unescape(c)}simplr.dataStorage.form={classes:{simplr:"_simplr",formEntry:"formEntry",formError:"formError",fieldError:"errorField",textError:"errorText",textInformation:"informationText"},
defaultRules:["notempty"],defaultLabel:"_LABEL_",rules:{},labels:{},codes:{},validators:{}};simplr.form={addLabelAssociation:function(b){for(var a in b)simplr.dataStorage.form.labels[a]=b[a]},addValidationAssociation:function(b){for(var a in b)simplr.dataStorage.form.rules[a]=b[a]},addValidation:function(b){for(var a in b)simplr.dataStorage.form.validators[a]=b[a]},addCode:function(b){for(var a in b)simplr.dataStorage.form.codes[a]=b[a]},getValues:function(a){var b={};a=a&&"string"==typeof a?document.querySelector(a).querySelectorAll("input, select, textarea"):
a.querySelectorAll("input, select, textarea");for(var c=0;c<a.length;c++){var g=a[c];"button"==g.type||"reset"==g.type||"submit"==g.type||"radio"==g.type&&!g.checked||("checkbox"==g.type?b[g.name]=g.checked?"on"==g.value?!0:g.value.trim():!1:(b[g.name]=g.value,"password"!=g.type&&"file"!=g.type&&(b[g.name]=b[g.name].trim(),g.value=b[g.name])))}return b},validate:function(b,d){var e={},g;for(g in d){for(var f={value:d[g],label:simplr.dataStorage.form.labels[g]?simplr.dataStorage.form.labels[g]:simplr.dataStorage.form.defaultLabel,
rules:[]},k=0;k<simplr.dataStorage.form.defaultRules.length;k++)f.rules.push(simplr.dataStorage.form.defaultRules[k]);if("function"==typeof simplr.dataStorage.form.rules[g])simplr.dataStorage.form.rules[g](f.rules);e[g]=f}var e={data:e||"",valid:!0,codes:{}},h;for(h in e.data){g=e.data[h];e.codes[h]={success:[],error:[]};for(f=0;f<g.rules.length;f++){var k=g.rules[f],l;l=simplr.dataStorage.form.validators[k]?simplr.dataStorage.form.validators[k](g.value):simplr.dataStorage.form.validators.missingvalidator(g.value);
var k=h,m=e;m.codes[k].success=m.codes[k].success.concat(l.successCodes);m.codes[k].error=m.codes[k].error.concat(l.errorCodes);l.valid||(m.valid=!1)}0==e.codes[h].error.length&&0==e.codes[h].success.length&&delete e.codes[h]}h=simplr.dataStorage.form.classes;g=b&&"string"==typeof b?document.querySelector(b):b;k=g.querySelectorAll("."+h.formError+"."+h.simplr+", ."+h.fieldError+"."+h.simplr);for(f=0;f<k.length;f++)k[f].className=k[f].className.replace(h.formError,"").replace(h.fieldError,"").replace(h.simplr,
"");k=g.querySelectorAll("."+h.textInformation+"."+h.simplr+", ."+h.textError+"."+h.simplr);for(f=k.length-1;0<=f;f--)k[f].parentNode.removeChild(k[f]),k[f].className=k[f].className.replace(h.simplr,"");for(var p in e.codes){f=e.codes[p];k=[f.error,f.success];l="";for(f=0;2>f;f++)if(0<k[f].length){var m='<p class="'+(0==f?h.textError:h.textInformation)+" "+h.simplr+'">',n;n=k[f][0];n=simplr.dataStorage.form.codes[n]?a({label:e.data[p].label},simplr.dataStorage.form.codes[n]):a({label:n},"$[label] is UNDEFINED");
l+=m+n+"</p>"}if(f=g.querySelector("[name='"+p+"']"))if(f.className+=" "+h.fieldError+" "+h.simplr,f=c(f))f.className+=" "+h.formError+" "+h.simplr,f.innerHTML+=l}return e.valid}}}(),function(){function c(a,b){if(typeof a==typeof b){if("object"!=typeof a)return a==b;if(a&&void 0!==a.length){if(a.length==b.length){for(var d=0,e=a.length;d<e;d++)if(!c(a[d],b[d]))return!1;return!0}}else{for(d in a)if(!c(a[d],b[d]))return!1;var g=e=0;for(d in a)e++;for(d in b)g++;return e==g}}return!1}simplr.form.addCode({eMissingValidator:"Missing Validator",
eAlphaNumeric:"$[label] is not alphanumeric.",eAmericanExpress:"$[label] is not a valid AMERICAN EXPRESS number.",eDinersClub:"$[label] is not a valid DINERS CLUB number.",eDiscover:"$[label] is not a valid DISCOVER number.",eEmail:"$[label] is not an email address.",eEqual:"$[label] does not match.",eMastercard:"$[label] is not a valid MASTERCARD number.",eEmpty:"$[label] is empty.",eNumber:"$[label] is not a number.",ePhoneNumber:"$[label] is not a valid Phone Number.",ePostalCode:"$[label] is not a Postal Code.",
eVisa:"$[label] is not a valid VISA number."});simplr.form.addValidation({missingvalidator:function(a){return{valid:!1,successCodes:[],errorCodes:["eMissingValidator"]}},alphanumeric:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^\w*$/.test(a)||(b.valid=!1,b.errorCodes.push("eAlphaNumeric"));return b},americanexpress:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^3(4|7)\d{2}-?\d{6}-?\d{5}$/.test(a)||(b.valid=!1,b.errorCodes.push("eAmericanExpress"));return b},dinersclub:function(a){var b=
{valid:!0,successCodes:[],errorCodes:[]};/^3[0,6,8]\d{12}$/.test(a)||(b.valid=!1,b.errorCodes.push("eDinersClub"));return b},discover:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^6011-?\d{4}-?\d{4}-?\d{4}$/.test(a)||(b.valid=!1,b.errorCodes.push("eDiscover"));return b},email:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/.+@.+/.test(a)||(b.valid=!1,b.errorCodes.push("eEmail"));return b},equal:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};if(a&&"object"==typeof a&&
void 0!==a.length)for(var d=0;d<a.length;d++)if(!c(a[0],a[d])){b.valid=!1;b.errorCodes.push("eEqual");break}return b},mastercard:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^5[1-5]\d{2}-?\d{4}-?\d{4}-?\d{4}$/.test(a)||(b.valid=!1,b.errorCodes.push("eMastercard"));return b},notempty:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};a?"string"==typeof a?b.valid=""!=a.trim():void 0!==a.length&&(b.valid=0!=a.length):b.valid=!1;b.valid||b.errorCodes.push("eEmpty");return b},number:function(a){var b=
{valid:!0,successCodes:[],errorCodes:[]};if(isNaN(parseFloat(a))||!isFinite(a))b.valid=!1,b.errorCodes.push("eNumber");return b},phonenumber:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^\d{10}$/.test(a)||(b.valid=!1,b.errorCodes.push("ePhoneNumber"));return b},postalcode:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^\d{5}([\-]?\d{4})?$/.test(a)||(b.valid=!1,b.errorCodes.push("ePostalCode"));return b},visa:function(a){var b={valid:!0,successCodes:[],errorCodes:[]};/^4\d{3}-?\d{4}-?\d{4}-?\d{4}$/.test(a)||
(b.valid=!1,b.errorCodes.push("eVisa"));return b}})}())})();